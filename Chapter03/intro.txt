
영속성 컨텍스트 , 엔터티 관리

1. 영속성 컨텍스트
	- 	컨텍스트는 컨테이너라는 의미.
		엔터티를 저장해서 관리하는 공간 또는 영역임.
	-	컨테이너의 핵심 기능은 persistence.xml의 메타 정보를 참조하여
		애플리케이션 운영에 필요한 객체를 생성하고 관리하는 것
	-	영속성 컨테이너는 persistence.xml의 메타 정보를 참조하여 
		메타정보를 로딩하고, Entity Manager 객체를 생성할 때
		자동으로 생성.
	-	Entity Manager가 제공하는 메소드를 통해서만 접근이 가능.
	-	영속성 컨테이너가 관리하는 엔터티의 상태는
		생성, 관리, 분리, 삭제 의 네 가지 상태로 구분.
		
2. 관리상태
	- 엔터티를 영속성 컨테이너에 등록.
	- Entity Manager의 persist()
		엔터티 생성 -> 컨테이너에 등록
	  Entity Manager의 find()
	  	DB 조회 -> 엔터티 생성 -> 컨테이너에 등록 -> 요청한 쪽에 엔터티를 전달  
	- Entity 가 DB 에 저장(insert)
		반드시 트랜잭션 안에서 persist() 호출이 되어야 함.
	  
3. 분리상태
	- 영속 컨테이너에 있던 엔터티가 특정 작업에 의해서 영속 컨테이너를 벗어난 상태.
	- 엔터티를 수정해도 데이터베이스에 반영이 되지 않음. Dirty Check 를 수행하지 않음.
	- 생성 상태와 분리 상태의 차이점.
	  생성 상태 : persist() 를 호출하지 않음. 식별자가 없는 상태.
	  분리 상태 : persist() 를 호출한 적이 있음. 식별자가 있는 상태.
	- 분리 상태 전환을 위한 Entity Manager 의 메소드
	  - detach(entity)
	       특정 엔터티만 분리
	  - clear()
	  	컨테이너 초기화. 영속 컨테이너가 관리하는 모든 엔터티를 분리 상태로 전환.
	  - close()
	  	컨테이너 종료. 엔터티가 있다면, 먼저 분리 상태로 모두 전환 후, 종료.


	  